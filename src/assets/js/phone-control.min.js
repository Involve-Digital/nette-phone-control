!function(e,o){if(e.Nette)if("function"==typeof define&&define.amd)define(function(){return o(e)});else if("object"==typeof module&&"object"==typeof module.exports)module.exports=o(e);else{var t=!e.Nette||!e.Nette.noInit;e.Nette.PhoneControl=o(e),t&&e.Nette.PhoneControl.initOnLoad()}}("undefined"!=typeof window?window:this,function(e){"use strict";var o={version:"1.0",options:{flag:!0,otherText:"-jin√©-",singleOptionPaddingOffset:15,multiOptionsPaddingOffset:20},initOnLoad:function(){Nette.onDocumentReady(function(){for(var e=document.querySelectorAll(".phone-control:not([data-initialized])"),t=0;t<e.length;t++)o.initControl(e[t]);document.onclick=function(e){if(!e.target.classList.contains("phone-control-selected"))for(var o=document.querySelectorAll(".phone-control-region-code"),t=0;t<o.length;t++)o[t].classList.remove("phone-control-active")},document.onkeyup=function(e){if("Escape"===e.code)for(var o=document.querySelectorAll(".phone-control-region-code"),t=0;t<o.length;t++)o[t].classList.remove("phone-control-active")},Nette.validators.InvolveFormsControlsPhoneControl_validateNumber=(e=>o.validateControl(e))})},initControl:function(e){var t=e,n=o.getRegionCodeControlByPhoneControl(t);if(t.hasAttribute("data-region-codes")){for(var i=JSON.parse(t.getAttribute("data-region-codes")),l=Object.keys(i),r=Object.values(i),a=parseInt(t.getAttribute("data-strict")),s=o.hasSingleOption(t),c=document.createElement("ul"),d="",u='<svg style="display:inline;position:relative;width:10px;vertical-align:top;top:8px;left:4px;" xmlns="http://www.w3.org/2000/svg"  x="0px" y="0px" viewBox="0 0 1000 1000" enable-background="new 0 0 1000 1000" xml:space="preserve">\n<g><path d="M961.2,236.5c-38.4-38.4-101.2-38.4-139.6,0L500,558L178.4,236.5c-38.4-38.4-101.2-38.4-139.6,0C0.4,274.9,0.4,337.6,38.8,376l388.1,388.1c20,20,46.8,29,73.1,28.1c26.5,0.9,53.1-8.1,73.1-28.1L961.3,376C999.6,337.6,999.6,274.8,961.2,236.5z"/></g>\n</svg>',p=0;p<r.length;p++)0===p&&(d='<li class="phone-control-selected">+'+r[p]+(s?"":u)+"</li>"),d=d+"<li>+"+r[p]+(o.options.flag?'<img src="https://flagcdn.com/16x12/'+l[p].toLowerCase()+'.png">':"")+"</li>";a||(d=d+'<li class="phone-control-other">'+o.options.otherText+"</li>"),c.classList.add("phone-control-region-code"),c.innerHTML=d;var v=c.querySelector(".phone-control-selected");v.onclick=function(e){if(e.stopPropagation(),"INPUT"!==document.activeElement.tagName){if(!s){for(var o=document.querySelectorAll(".phone-control-region-code"),t=999,n=0;n<o.length;n++)o[n].style.zIndex=t--,o[n]!==c&&o[n].classList.remove("phone-control-active");c.classList.toggle("phone-control-active")}}else c.classList.remove("phone-control-active")};for(var g=c.querySelectorAll("li:not([class])"),f=0;f<g.length;f++){g[f].onclick=function(){v.innerHTML=this.innerText+(s?"":u),c.classList.remove("phone-control-active"),o.setRegionCodeControlValue(void 0,n,v),o.adjustPhoneControlPadding(t,c),t.focus()}}if(!a)c.querySelector(".phone-control-other").onclick=function(){v.innerHTML='+<input type="tel">'+(s?"":u),c.classList.remove("phone-control-active");var e=v.querySelector("input");e.onkeyup=function(){this.value=this.value.replace(/[^0-9-]/g,""),o.setRegionCodeControlValue(void 0,n,v)},e.focus(),o.adjustPhoneControlPadding(t,c)};if(t.oninput=t.onchange=t.onpaste=t.onkeyup=function(e){this.value.includes("+")?(c.classList.add("phone-control-disabled"),o.setRegionCodeControlValue(null,n,v)):(c.classList.remove("phone-control-disabled"),o.setRegionCodeControlValue(void 0,n,v)),o.adjustPhoneControlPadding(t,c),o.validateControl(t),e.stopPropagation()},t.parentNode.insertBefore(c,t),t.dataset.initialized=1,t.value.includes("+"))o.setRegionCodeControlValue(null,n,v),c.classList.add("phone-control-disabled");else if(n.value){var h=n.value;o.setRegionCodeControlValue(h,n,v),r.includes(h.replace("+",""))?v.innerHTML=h+(s?"":u):v.innerHTML='+<input type="tel" value="'+h.replace("+","")+'">'+(s?"":u)}else o.setRegionCodeControlValue(void 0,n,v);o.adjustPhoneControlPadding(t,c),o.validateControl(t)}},validateControl:function(e){if("undefined"==typeof libphonenumber)return console.warn('PhoneControl: for JS validation include "libphonenumber-js" library,or overwrite "Nette.PhoneControl.validateControl" with your own validation.'),!0;var t=o.getRegionCodeControlByPhoneControl(e);try{var n=new libphonenumber.parsePhoneNumber(t.value+e.value);if(!t.value&&e.getAttribute("data-strict")){var i=JSON.parse(e.getAttribute("data-region-codes"));i=Object.values(i),r=!1;for(var l=0;l<i.length;l++)e.value.startsWith("+"+i[l])&&(r=n.isValid())}else var r=n.isValid()}catch(e){r=!1}return r},hasSingleOption:function(e){var o=JSON.parse(e.getAttribute("data-region-codes")),t=Object.values(o),n=parseInt(e.getAttribute("data-strict"));return 1===t.length&&1===n},adjustPhoneControlPadding:function(e,t){var n=o.hasSingleOption(e);t.classList.contains("phone-control-disabled")?e.style.paddingLeft=null:e.style.paddingLeft=t.offsetWidth+(n?o.options.singleOptionPaddingOffset:o.options.multiOptionsPaddingOffset)+"px"},setRegionCodeControlValue:function(e,o,t){void 0===e?t.innerHTML.includes("input")?o.value="+"+t.querySelector("input").value:o.value=t.innerText:o.value=e},getRegionCodeControlByPhoneControl:function(e){var o=e.getAttribute("name");return o.includes("]")&&(o=o.substring(o.length-1)),e.closest("form").querySelector('[name*="'+o+'"][name*="RegionCode"]')}};return o});
